{% load static %}
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>{% block title %}Tic Tac Toe{% endblock %}</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: linear-gradient(135deg, #2c3e50, #4ca1af); margin:0; padding:0; color:#fff; }
        header { background: rgba(0,0,0,0.3); padding:15px; text-align:center; font-size:28px; font-weight:bold; text-shadow:1px 1px 3px #000; }
        nav { display:flex; justify-content:center; background: rgba(255,255,255,0.1); padding:10px; backdrop-filter:blur(10px); }
        nav a { color:#fff; text-decoration:none; padding:12px 20px; margin:0 8px; border-radius:8px; transition: background 0.3s, transform 0.2s; }
        nav a:hover { background: rgba(255,255,255,0.2); transform:scale(1.1); }
        main { text-align:center; padding:20px; }
        table { margin:20px auto; border-collapse:collapse; background: rgba(255,255,255,0.15); border-radius:10px; overflow:hidden; box-shadow:0 0 10px rgba(0,0,0,0.3); }
        th, td { border:1px solid rgba(255,255,255,0.2); padding:10px 20px; color:#fff; }
        th { background: rgba(255,255,255,0.2); }
        button, .btn { background:#4CAF50; color:white; border:none; padding:10px 15px; margin:5px; border-radius:6px; cursor:pointer; font-size:15px; transition: background 0.3s, transform 0.2s; }
        button:hover, .btn:hover { background:#45a049; transform:scale(1.05); }
        .danger { background:#e74c3c; }
        .danger:hover { background:#c0392b; }
        footer { margin-top:40px; text-align:center; padding:10px; background: rgba(0,0,0,0.3); font-size:14px; }
        .winner { color:#ffeb3b; text-shadow:0 0 10px #fff; font-size:24px; font-weight:bold; }
        #music-btn { position:fixed; top:15px; right:15px; z-index:999; }
    </style>
</head>
<body>
    <header>üéÆ Tic Tac Toe</header>
    <nav>
        <a href="{% url 'index' %}">üè† –ì–ª–∞–≤–Ω–∞—è</a>
        <a href="{% url 'new_game' %}">üéÆ –ù–æ–≤–∞—è –∏–≥—Ä–∞</a>
        <a href="{% url 'results' %}">üìä –ò—Å—Ç–æ—Ä–∏—è</a>
        <a href="{% url 'clear_all' %}" class="btn danger">üßπ –û—á–∏—Å—Ç–∏—Ç—å –≤—Å—ë</a>
    </nav>

    <!-- –ê—É–¥–∏–æ -->
    <audio id="bg-music" loop>
        <source src="{% static 'tictactoe/sounds/music.mp3' %}" type="audio/mpeg">
    </audio>
    <audio id="click-sound">
        <source src="{% static 'tictactoe/sounds/musicc.mp3' %}" type="audio/mpeg">
    </audio>
    <audio id="win-sound">
        <source src="{% static 'tictactoe/sounds/musiccc.mp3' %}" type="audio/mpeg">
    </audio>

    <!-- –ö–Ω–æ–ø–∫–∞ –º—É–∑—ã–∫–∏ -->
    <button id="music-btn" class="btn" onclick="toggleMusic()">‚èØ –ú—É–∑—ã–∫–∞</button>

    <script>
        const music = document.getElementById("bg-music");
        const clickSound = document.getElementById("click-sound");
        const winSound = document.getElementById("win-sound");

        music.volume = 0.5;

        // –í–∫–ª—é—á–∞–µ–º –º—É–∑—ã–∫—É –µ—Å–ª–∏ –≤ localStorage —É–∫–∞–∑–∞–Ω–æ
        if(localStorage.getItem('musicPlaying') === 'true') {
            music.play().catch(() => {});
        }

        function toggleMusic() {
            if(music.paused) {
                music.play();
                localStorage.setItem('musicPlaying','true');
            } else {
                music.pause();
                localStorage.setItem('musicPlaying','false');
            }
        }

        // –ó–≤—É–∫ –Ω–∞ –≤—Å–µ –∫–Ω–æ–ø–∫–∏
        document.querySelectorAll('button').forEach(btn => {
            btn.addEventListener('click', () => {
                clickSound.currentTime = 0;
                clickSound.play();
            });
        });

        // –ó–≤—É–∫ –ø–æ–±–µ–¥—ã
        {% if game.winner %}
        winSound.play();
        {% endif %}
    </script>

    <main>
        {% block content %}{% endblock %}
    </main>

    <footer>¬© 2025 Django Tic Tac Toe</footer>
</body>
</html>
